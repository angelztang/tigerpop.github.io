{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Routes,Route,Navigate,useLocation,useNavigate}from'react-router-dom';import{isAuthenticated,getNetid,handleCasCallback}from'./services/authService';import Navbar from'./components/Navbar';import MarketplacePage from'./pages/MarketplacePage';import LoginPage from'./pages/LoginPage';import Dashboard from'./pages/Dashboard';import ListingDetail from'./pages/ListingDetail';import'./index.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const App=()=>{const[authenticated,setAuthenticated]=useState(isAuthenticated());const[netid,setNetid]=useState(getNetid());const location=useLocation();const navigate=useNavigate();useEffect(()=>{// Handle CAS callback if there's a token in the URL\nconst params=new URLSearchParams(location.search);const token=params.get('token');if(token){handleCasCallback(token);// Remove token from URL and redirect to dashboard\nnavigate('/dashboard',{replace:true});}// Update authentication state when it changes\nconst checkAuth=()=>{setAuthenticated(isAuthenticated());setNetid(getNetid());};// Check auth state on mount and when localStorage changes\nwindow.addEventListener('storage',checkAuth);checkAuth();return()=>{window.removeEventListener('storage',checkAuth);};},[location,navigate]);return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-100\",children:[/*#__PURE__*/_jsx(Navbar,{authenticated:authenticated,netid:netid}),/*#__PURE__*/_jsx(\"main\",{className:\"container mx-auto px-4 py-8\",children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(MarketplacePage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/marketplace\",element:/*#__PURE__*/_jsx(MarketplacePage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",element:authenticated?/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\"}):/*#__PURE__*/_jsx(LoginPage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/dashboard\",element:authenticated?/*#__PURE__*/_jsx(Dashboard,{}):/*#__PURE__*/_jsx(Navigate,{to:\"/login\"})}),/*#__PURE__*/_jsx(Route,{path:\"/listings/:id\",element:/*#__PURE__*/_jsx(ListingDetail,{})})]})})]});};export default App;","map":{"version":3,"names":["React","useState","useEffect","Routes","Route","Navigate","useLocation","useNavigate","isAuthenticated","getNetid","handleCasCallback","Navbar","MarketplacePage","LoginPage","Dashboard","ListingDetail","jsx","_jsx","jsxs","_jsxs","App","authenticated","setAuthenticated","netid","setNetid","location","navigate","params","URLSearchParams","search","token","get","replace","checkAuth","window","addEventListener","removeEventListener","className","children","path","element","to"],"sources":["/Users/angel/Documents/Princeton/COS 333/tigerpop.github.io-1/frontend/src/App.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Routes, Route, Navigate, useLocation, useNavigate } from 'react-router-dom';\nimport { isAuthenticated, getNetid, handleCasCallback } from './services/authService';\nimport Navbar from './components/Navbar';\nimport MarketplacePage from './pages/MarketplacePage';\nimport LoginPage from './pages/LoginPage';\nimport Dashboard from './pages/Dashboard';\nimport ListingDetail from './pages/ListingDetail';\nimport './index.css';\n\nconst App: React.FC = () => {\n  const [authenticated, setAuthenticated] = useState<boolean>(isAuthenticated());\n  const [netid, setNetid] = useState<string | null>(getNetid());\n  const location = useLocation();\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    // Handle CAS callback if there's a token in the URL\n    const params = new URLSearchParams(location.search);\n    const token = params.get('token');\n    \n    if (token) {\n      handleCasCallback(token);\n      // Remove token from URL and redirect to dashboard\n      navigate('/dashboard', { replace: true });\n    }\n\n    // Update authentication state when it changes\n    const checkAuth = () => {\n      setAuthenticated(isAuthenticated());\n      setNetid(getNetid());\n    };\n\n    // Check auth state on mount and when localStorage changes\n    window.addEventListener('storage', checkAuth);\n    checkAuth();\n\n    return () => {\n      window.removeEventListener('storage', checkAuth);\n    };\n  }, [location, navigate]);\n\n  return (\n    <div className=\"min-h-screen bg-gray-100\">\n      <Navbar authenticated={authenticated} netid={netid} />\n      <main className=\"container mx-auto px-4 py-8\">\n        <Routes>\n          <Route path=\"/\" element={<MarketplacePage />} />\n          <Route path=\"/marketplace\" element={<MarketplacePage />} />\n          <Route \n            path=\"/login\" \n            element={authenticated ? <Navigate to=\"/dashboard\" /> : <LoginPage />} \n          />\n          <Route \n            path=\"/dashboard\" \n            element={authenticated ? <Dashboard /> : <Navigate to=\"/login\" />} \n          />\n          <Route path=\"/listings/:id\" element={<ListingDetail />} />\n        </Routes>\n      </main>\n    </div>\n  );\n};\n\nexport default App; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}