{"ast":null,"code":"// Shows seller's listings + create listing button\nimport React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{getUserListings,createListing,deleteListing}from'../services/listingService';import{getUserId}from'../services/authService';import ListingForm from'../components/ListingForm';import ListingCard from'../components/ListingCard';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SellerDashboard=()=>{const navigate=useNavigate();const[listings,setListings]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[showForm,setShowForm]=useState(false);const[isSubmitting,setIsSubmitting]=useState(false);const[activeFilter,setActiveFilter]=useState('all');useEffect(()=>{fetchListings();},[]);const fetchListings=async()=>{try{const userId=getUserId();if(!userId){setError('User not authenticated');return;}const data=await getUserListings(userId);setListings(data);}catch(err){setError('Failed to load listings');console.error('Error fetching listings:',err);}finally{setLoading(false);}};const handleListingCreated=async formData=>{setIsSubmitting(true);setError(null);try{const userId=getUserId();if(!userId){setError('User not authenticated');return;}const listingData={...formData,price:parseFloat(formData.price),user_id:parseInt(userId)};await createListing(listingData);setShowForm(false);fetchListings();}catch(err){setError('Failed to create listing');console.error('Error creating listing:',err);}finally{setIsSubmitting(false);}};const handleDeleteListing=async id=>{try{await deleteListing(id);setListings(listings.filter(listing=>listing.id!==id));}catch(err){setError('Failed to delete listing');console.error('Error deleting listing:',err);}};const filteredListings=listings.filter(listing=>{if(activeFilter==='all')return true;if(activeFilter==='selling')return listing.status==='available';if(activeFilter==='sold')return listing.status==='sold';return true;});if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center min-h-screen\",children:\"Loading...\"});}return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-100 py-12 px-4 sm:px-6 lg:px-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold\",children:\"My Listings\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowForm(true),className:\"bg-orange-500 text-white px-4 py-2 rounded-md hover:bg-orange-600 transition-colors\",children:\"Create New Listing\"})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-4 bg-red-100 text-red-700 rounded-md\",children:error}),showForm&&/*#__PURE__*/_jsx(ListingForm,{onSubmit:handleListingCreated,isSubmitting:isSubmitting,onClose:()=>setShowForm(false)}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-6 border-b border-gray-200\",children:/*#__PURE__*/_jsxs(\"nav\",{className:\"-mb-px flex space-x-8\",\"aria-label\":\"Tabs\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveFilter('all'),className:`${activeFilter==='all'?'border-orange-500 text-orange-600':'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:\"All\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveFilter('selling'),className:`${activeFilter==='selling'?'border-orange-500 text-orange-600':'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:\"Selling\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveFilter('sold'),className:`${activeFilter==='sold'?'border-orange-500 text-orange-600':'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:\"Sold\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6\",children:filteredListings.map(listing=>/*#__PURE__*/_jsx(ListingCard,{listing:listing,onDelete:()=>handleDeleteListing(listing.id)},listing.id))})]})});};export default SellerDashboard;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","getUserListings","createListing","deleteListing","getUserId","ListingForm","ListingCard","jsx","_jsx","jsxs","_jsxs","SellerDashboard","navigate","listings","setListings","loading","setLoading","error","setError","showForm","setShowForm","isSubmitting","setIsSubmitting","activeFilter","setActiveFilter","fetchListings","userId","data","err","console","handleListingCreated","formData","listingData","price","parseFloat","user_id","parseInt","handleDeleteListing","id","filter","listing","filteredListings","status","className","children","onClick","onSubmit","onClose","map","onDelete"],"sources":["/Users/angel/Documents/Princeton/COS 333/tigerpop.github.io/frontend/src/pages/SellerDashboard.tsx"],"sourcesContent":["// Shows seller's listings + create listing button\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { getUserListings, createListing, deleteListing } from '../services/listingService';\nimport { Listing, CreateListingData } from '../services/listingService';\nimport { getUserId } from '../services/authService';\nimport ListingForm from '../components/ListingForm';\nimport ListingCard from '../components/ListingCard';\n\ntype FilterTab = 'all' | 'selling' | 'sold';\n\nconst SellerDashboard: React.FC = () => {\n  const navigate = useNavigate();\n  const [listings, setListings] = useState<Listing[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [showForm, setShowForm] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [activeFilter, setActiveFilter] = useState<FilterTab>('all');\n\n  useEffect(() => {\n    fetchListings();\n  }, []);\n\n  const fetchListings = async () => {\n    try {\n      const userId = getUserId();\n      if (!userId) {\n        setError('User not authenticated');\n        return;\n      }\n      const data = await getUserListings(userId);\n      setListings(data);\n    } catch (err) {\n      setError('Failed to load listings');\n      console.error('Error fetching listings:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleListingCreated = async (formData: { title: string; description: string; price: string; category: string; images: string[] }) => {\n    setIsSubmitting(true);\n    setError(null);\n    try {\n      const userId = getUserId();\n      if (!userId) {\n        setError('User not authenticated');\n        return;\n      }\n\n      const listingData: CreateListingData = {\n        ...formData,\n        price: parseFloat(formData.price),\n        user_id: parseInt(userId)\n      };\n\n      await createListing(listingData);\n      setShowForm(false);\n      fetchListings();\n    } catch (err) {\n      setError('Failed to create listing');\n      console.error('Error creating listing:', err);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleDeleteListing = async (id: number) => {\n    try {\n      await deleteListing(id);\n      setListings(listings.filter(listing => listing.id !== id));\n    } catch (err) {\n      setError('Failed to delete listing');\n      console.error('Error deleting listing:', err);\n    }\n  };\n\n  const filteredListings = listings.filter(listing => {\n    if (activeFilter === 'all') return true;\n    if (activeFilter === 'selling') return listing.status === 'available';\n    if (activeFilter === 'sold') return listing.status === 'sold';\n    return true;\n  });\n\n  if (loading) {\n    return <div className=\"flex justify-center items-center min-h-screen\">Loading...</div>;\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-100 py-12 px-4 sm:px-6 lg:px-8\">\n      <div className=\"max-w-7xl mx-auto\">\n        <div className=\"flex justify-between items-center mb-8\">\n          <h1 className=\"text-3xl font-bold\">My Listings</h1>\n          <button\n            onClick={() => setShowForm(true)}\n            className=\"bg-orange-500 text-white px-4 py-2 rounded-md hover:bg-orange-600 transition-colors\"\n          >\n            Create New Listing\n          </button>\n        </div>\n\n        {error && (\n          <div className=\"mb-4 p-4 bg-red-100 text-red-700 rounded-md\">\n            {error}\n          </div>\n        )}\n\n        {showForm && (\n          <ListingForm\n            onSubmit={handleListingCreated}\n            isSubmitting={isSubmitting}\n            onClose={() => setShowForm(false)}\n          />\n        )}\n\n        <div className=\"mb-6 border-b border-gray-200\">\n          <nav className=\"-mb-px flex space-x-8\" aria-label=\"Tabs\">\n            <button\n              onClick={() => setActiveFilter('all')}\n              className={`${\n                activeFilter === 'all'\n                  ? 'border-orange-500 text-orange-600'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n              } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`}\n            >\n              All\n            </button>\n            <button\n              onClick={() => setActiveFilter('selling')}\n              className={`${\n                activeFilter === 'selling'\n                  ? 'border-orange-500 text-orange-600'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n              } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`}\n            >\n              Selling\n            </button>\n            <button\n              onClick={() => setActiveFilter('sold')}\n              className={`${\n                activeFilter === 'sold'\n                  ? 'border-orange-500 text-orange-600'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n              } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`}\n            >\n              Sold\n            </button>\n          </nav>\n        </div>\n\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {filteredListings.map(listing => (\n            <ListingCard\n              key={listing.id}\n              listing={listing}\n              onDelete={() => handleDeleteListing(listing.id)}\n            />\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default SellerDashboard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}