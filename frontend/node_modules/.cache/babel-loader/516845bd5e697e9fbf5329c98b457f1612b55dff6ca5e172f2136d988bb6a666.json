{"ast":null,"code":"// Shows seller's listings + create listing button\nimport React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{createListing,deleteListing,getUserListings}from'../services/listingService';import{getUserId}from'../services/authService';import ListingForm from'../components/ListingForm';import ListingCard from'../components/ListingCard';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SellerDashboard=()=>{const navigate=useNavigate();const[listings,setListings]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[showForm,setShowForm]=useState(false);const[isSubmitting,setIsSubmitting]=useState(false);const[activeFilter,setActiveFilter]=useState('all');const[deletingId,setDeletingId]=useState(null);useEffect(()=>{fetchListings();},[]);const fetchListings=async()=>{try{const userId=getUserId();if(!userId){setError('User not authenticated');return;}const data=await getUserListings(userId);setListings(data);}catch(err){setError('Failed to load listings');console.error('Error fetching listings:',err);}finally{setLoading(false);}};const handleListingCreated=async formData=>{setIsSubmitting(true);setError(null);try{const userId=getUserId();if(!userId){setError('User not authenticated');return;}const listingData={...formData,price:parseFloat(formData.price),user_id:parseInt(userId)};const response=await createListing(listingData);if(response){setShowForm(false);setTimeout(()=>{navigate('/marketplace',{replace:true});},0);}}catch(err){console.error('Error in listing creation response:',err);setShowForm(false);setTimeout(()=>{navigate('/marketplace',{replace:true});},0);}finally{setIsSubmitting(false);}};const handleDeleteListing=async id=>{setDeletingId(id);try{await deleteListing(id);setListings(listings.filter(listing=>listing.id!==id));setError(null);}catch(err){setError('Failed to delete listing');console.error('Error deleting listing:',err);}finally{setDeletingId(null);}};const filteredListings=listings.filter(listing=>{if(activeFilter==='all')return true;if(activeFilter==='selling')return listing.status==='available';if(activeFilter==='sold')return listing.status==='sold';return true;});if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center min-h-screen\",children:\"Loading...\"});}return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-100 py-12 px-4 sm:px-6 lg:px-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold\",children:\"My Listings\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowForm(true),className:\"bg-orange-500 text-white px-4 py-2 rounded-md hover:bg-orange-600 transition-colors\",children:\"Create New Listing\"})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-4 bg-red-100 text-red-700 rounded-md\",children:error}),showForm&&/*#__PURE__*/_jsx(ListingForm,{onSubmit:handleListingCreated,isSubmitting:isSubmitting,onClose:()=>setShowForm(false)}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-6 border-b border-gray-200\",children:/*#__PURE__*/_jsxs(\"nav\",{className:\"-mb-px flex space-x-8\",\"aria-label\":\"Tabs\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveFilter('all'),className:`${activeFilter==='all'?'border-orange-500 text-orange-600':'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:\"All\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveFilter('selling'),className:`${activeFilter==='selling'?'border-orange-500 text-orange-600':'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:\"Selling\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveFilter('sold'),className:`${activeFilter==='sold'?'border-orange-500 text-orange-600':'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:\"Sold\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6\",children:filteredListings.length>0?filteredListings.map(listing=>/*#__PURE__*/_jsx(ListingCard,{listing:listing,onDelete:()=>handleDeleteListing(listing.id),isDeleting:deletingId===listing.id},listing.id)):/*#__PURE__*/_jsxs(\"div\",{className:\"col-span-full text-center py-12\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xl text-gray-600\",children:\"You have no listings yet\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowForm(true),className:\"mt-4 bg-orange-500 text-white px-6 py-2 rounded-md hover:bg-orange-600 transition-colors\",children:\"Create Your First Listing\"})]})})]})});};export default SellerDashboard;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","createListing","deleteListing","getUserListings","getUserId","ListingForm","ListingCard","jsx","_jsx","jsxs","_jsxs","SellerDashboard","navigate","listings","setListings","loading","setLoading","error","setError","showForm","setShowForm","isSubmitting","setIsSubmitting","activeFilter","setActiveFilter","deletingId","setDeletingId","fetchListings","userId","data","err","console","handleListingCreated","formData","listingData","price","parseFloat","user_id","parseInt","response","setTimeout","replace","handleDeleteListing","id","filter","listing","filteredListings","status","className","children","onClick","onSubmit","onClose","length","map","onDelete","isDeleting"],"sources":["/Users/angel/Documents/Princeton/COS 333/tigerpop.github.io-1/frontend/src/pages/SellerDashboard.tsx"],"sourcesContent":["// Shows seller's listings + create listing button\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { getListings, createListing, deleteListing, Listing, CreateListingData, getUserListings } from '../services/listingService';\nimport { getUserId } from '../services/authService';\nimport ListingForm from '../components/ListingForm';\nimport ListingCard from '../components/ListingCard';\n\ntype FilterTab = 'all' | 'selling' | 'sold';\n\nconst SellerDashboard: React.FC = () => {\n  const navigate = useNavigate();\n  const [listings, setListings] = useState<Listing[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [showForm, setShowForm] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [activeFilter, setActiveFilter] = useState<FilterTab>('all');\n  const [deletingId, setDeletingId] = useState<number | null>(null);\n\n  useEffect(() => {\n    fetchListings();\n  }, []);\n\n  const fetchListings = async () => {\n    try {\n      const userId = getUserId();\n      if (!userId) {\n        setError('User not authenticated');\n        return;\n      }\n      const data = await getUserListings(userId);\n      setListings(data);\n    } catch (err) {\n      setError('Failed to load listings');\n      console.error('Error fetching listings:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleListingCreated = async (formData: { title: string; description: string; price: string; category: string; images: string[] }) => {\n    setIsSubmitting(true);\n    setError(null);\n    try {\n      const userId = getUserId();\n      if (!userId) {\n        setError('User not authenticated');\n        return;\n      }\n\n      const listingData: CreateListingData = {\n        ...formData,\n        price: parseFloat(formData.price),\n        user_id: parseInt(userId)\n      };\n\n      const response = await createListing(listingData);\n      if (response) {\n        setShowForm(false);\n        setTimeout(() => {\n          navigate('/marketplace', { replace: true });\n        }, 0);\n      }\n    } catch (err) {\n      console.error('Error in listing creation response:', err);\n      setShowForm(false);\n      setTimeout(() => {\n        navigate('/marketplace', { replace: true });\n      }, 0);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleDeleteListing = async (id: number) => {\n    setDeletingId(id);\n    try {\n      await deleteListing(id);\n      setListings(listings.filter(listing => listing.id !== id));\n      setError(null);\n    } catch (err) {\n      setError('Failed to delete listing');\n      console.error('Error deleting listing:', err);\n    } finally {\n      setDeletingId(null);\n    }\n  };\n\n  const filteredListings = listings.filter(listing => {\n    if (activeFilter === 'all') return true;\n    if (activeFilter === 'selling') return listing.status === 'available';\n    if (activeFilter === 'sold') return listing.status === 'sold';\n    return true;\n  });\n\n  if (loading) {\n    return <div className=\"flex justify-center items-center min-h-screen\">Loading...</div>;\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-100 py-12 px-4 sm:px-6 lg:px-8\">\n      <div className=\"max-w-7xl mx-auto\">\n        <div className=\"flex justify-between items-center mb-8\">\n          <h1 className=\"text-3xl font-bold\">My Listings</h1>\n          <button\n            onClick={() => setShowForm(true)}\n            className=\"bg-orange-500 text-white px-4 py-2 rounded-md hover:bg-orange-600 transition-colors\"\n          >\n            Create New Listing\n          </button>\n        </div>\n\n        {error && (\n          <div className=\"mb-4 p-4 bg-red-100 text-red-700 rounded-md\">\n            {error}\n          </div>\n        )}\n\n        {showForm && (\n          <ListingForm\n            onSubmit={handleListingCreated}\n            isSubmitting={isSubmitting}\n            onClose={() => setShowForm(false)}\n          />\n        )}\n\n        <div className=\"mb-6 border-b border-gray-200\">\n          <nav className=\"-mb-px flex space-x-8\" aria-label=\"Tabs\">\n            <button\n              onClick={() => setActiveFilter('all')}\n              className={`${\n                activeFilter === 'all'\n                  ? 'border-orange-500 text-orange-600'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n              } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`}\n            >\n              All\n            </button>\n            <button\n              onClick={() => setActiveFilter('selling')}\n              className={`${\n                activeFilter === 'selling'\n                  ? 'border-orange-500 text-orange-600'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n              } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`}\n            >\n              Selling\n            </button>\n            <button\n              onClick={() => setActiveFilter('sold')}\n              className={`${\n                activeFilter === 'sold'\n                  ? 'border-orange-500 text-orange-600'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n              } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`}\n            >\n              Sold\n            </button>\n          </nav>\n        </div>\n\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {filteredListings.length > 0 ? (\n            filteredListings.map(listing => (\n              <ListingCard\n                key={listing.id}\n                listing={listing}\n                onDelete={() => handleDeleteListing(listing.id)}\n                isDeleting={deletingId === listing.id}\n              />\n            ))\n          ) : (\n            <div className=\"col-span-full text-center py-12\">\n              <p className=\"text-xl text-gray-600\">You have no listings yet</p>\n              <button\n                onClick={() => setShowForm(true)}\n                className=\"mt-4 bg-orange-500 text-white px-6 py-2 rounded-md hover:bg-orange-600 transition-colors\"\n              >\n                Create Your First Listing\n              </button>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default SellerDashboard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}